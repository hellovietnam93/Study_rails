<% if @class_room.lecturer.present? && current_user == @class_room.lecturer.user &&
  current_user.lecturer? %>
  <h3><%= t "imports.import_data" %></h3>
  <div class="row">
    <div class="col-md-12">
      <%= form_tag class_room_questions_path(@class_room), method: :post,
        multipart: true do %>
        <div class="control-group">
          <% Settings.imports.data_types.each do |data_type| %>
            <% if data_type.model == "question" %>
              <div class="list-group-items select-file-buttons" data-id="<%= data_type.model %>">
                <div class="checkbox">
                  <label class="control-label">
                    <%= check_box_tag "type[]", "#{data_type.model}", nil,
                      class: "check-box-tag hidden",
                      id: "check-box-tag-file-select-#{data_type.model}" %>
                    <%= t "imports.#{data_type.model.to_sym}" %>
                  </label>
                </div>
                <div class="file-field-uploaded">
                  <%= file_field_tag "file[]", id: "file-select-#{data_type.model}",
                    class: "file-select", data: {model: "#{data_type.model}"},
                    accept: allowed_file(data_type.model) %>
                </div>
                <div id="loading-image-<%= data_type.model %>" class=" load-image hidden">
                  <%= image_tag "loading.gif", size: Settings.imports.image_loading_size %>
                </div>
              </div>
              <hr>
            <% end %>
          <% end %>
        </div>
        <div>
          <%= submit_tag t("imports.import"),
            data: {disable_with: t("imports.importing")},
            class: "btn btn-primary",
            id: "form-submit-btn" %>
        </div>
      <% end %>
    </div>
  </div>
<% end %>

<div class="col-md-8">
  <table class="questions table table-hover">
    <thead><%= render "questions/header" %></thead>
    <tbody class="tbody">
      <%= render @questions %>
    </tbody>
  </table>
</div>

<div class="col-md-4">
  <%= nested_form_for @class_room do |f| %>
    <%= f.fields_for :questions do |question_form| %>
      <%= question_form.hidden_field :course_id, value: @class_room.course.id %>
      <%= question_form.text_field :name, class: "form-control" %>
      <%= question_form.select :question_type,
        options_from_collection_for_select(
        i18n_enum(:questions, :question_type), :key, :value,
        question_form.object.question_type), {}, class: "form-control" %>
      <%= question_form.select :priority,
        options_from_collection_for_select(
        i18n_enum(:questions, :priority), :key, :value,
        question_form.object.priority), {}, class: "form-control" %>
      <%= question_form.link_to_remove "Remove this question" %>

      <%= question_form.fields_for :answers do |answer_form| %>
        <%= answer_form.text_field :content, class: "form-control" %>
        <%= answer_form.check_box :correct, class: "checkbox" %>
        <%= answer_form.link_to_remove "Remove this answer" %>
      <% end %>
      <p><%= question_form.link_to_add "Add a answer", :answers %></p>
    <% end %>
    <p><%= f.link_to_add "Add a question", :questions %></p>
    <%= f.submit "ok"%>
  <% end%>
</div>
